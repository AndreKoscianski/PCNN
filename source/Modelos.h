// Dados gerados no Octave (/Matlab)

double Gdados_sem_ruido [] = {
1,0.7918635477989981,0.6198400803607899,0.4794073922614148,0.3662218909057421,0.2761943746732524,0.2055509859312635,0.1508765324043086,0.1091388146895854,0.0776940015888606,0.05427429784476569,0.03696003659113376,0.0241388478866284,0.01445471535494761,0.006749601135234751,0,
0.9373776908023483,0.7364622721881258,0.5715103277535142,0.4378595539700007,0.3310441582655838,0.2468774056179454,0.1815170801799187,0.1315108268935335,0.0938201076409324,0.06582319260898556,0.04529900664489802,0.03039462356491258,0.01957969173360055,0.01159110826346644,0.005370933885420838,0,
0.8747553816046967,0.6813040944363309,0.5236509543126915,0.3969793710945813,0.2966901717039006,0.2184918460777138,0.1584708822338361,0.1131389119036882,0.07945558204135487,0.05482811254657114,0.03709013739311756,0.02446348728206272,0.01550700063744092,0.009056299051166046,0.004157874047382182,0,
0.812133072407045,0.6264157032683645,0.4763124636260651,0.3568358681242619,0.2632405807861881,0.1911224980009437,0.1364943383936275,0.09583421134627847,0.06610638912724567,0.04475601087509638,0.02968136844714667,0.01918856485856237,0.0119336492557904,0.006856914149438279,0.003113094723484807,0,
0.7495107632093934,0.5718288872266502,0.4295547235944343,0.3175101981969822,0.2307890624265784,0.1648662153907456,0.1156789237227127,0.07967617573868269,0.05383590653541175,0.03565292063052285,0.0231025940527492,0.01458662827878752,0.008867236890737925,0.004995340503801402,0.002236921553852184,0,
0.6868884540117417,0.5175820838743904,0.3834497358341951,0.2790990587998139,0.1994457066678183,0.1398346404723509,0.09612729625150547,0.0647506802550982,0.04270896435121106,0.02756199599404021,0.0173777651154107,0.01066703551640322,0.006308101882471789,0.003468265672589818,0.001526563881800598,0,
0.62426614481409,0.4637225714407157,0.3380855175367695,0.2417194001978355,0.169341558318872,0.1161577067836834,0.0779552059816308,0.05115018779936881,0.03279048393798505,0.02052110249861433,0.01252200319714909,0.007428897024959822,0.004246939148679353,0.002264993040136625,0.000975250049381782,0,
0.5616438356164384,0.4103096618512025,0.2935716931878912,0.2055150679467822,0.1406348040968287,0.09398811906938144,0.06129356610260975,0.03897335967378771,0.02414312429722319,0.01455930658698287,0.008537780161858145,0.004857618801961721,0.002662107830425423,0.001365662976008941,0.000571358005649655,0,
0.4990215264187867,0.3574195224405849,0.2500478216034132,0.170666440612912,0.1135193528681398,0.07350703925689371,0.0462903979928138,0.02832348670868249,0.01682323535329503,0.009691731829564459,0.005409934448821997,0.002920898683730531,0.001516903901603946,0.0007396925832704603,0.0002977418204723364,0,
0.436399217221135,0.3051527826822042,0.2076963080681984,0.1374048921027773,0.08823696790829909,0.05493114228992286,0.03311191148828586,0.01930451221278185,0.01087391583344745,0.005912009925973677,0.00309934849595912,0.001564518716270286,0.0007574201019709969,0.0003450502587909822,0.0001316273843852632,0,
0.3737769080234833,0.2536472006738392,0.166763442385161,0.1060353803773544,0.06509474368001303,0.03852084026368626,0.02194093192581852,0.0120122424014087,0.00631316675624367,0.003181338671974654,0.001535411303846951,0.0007088431345553111,0.0003121920330923075,0.000129405170378808,4.566448991317e-05,0,
0.3111545988258317,0.2031002485564762,0.1275958595590632,0.07697343771163144,0.04449056045825515,0.02458810828586269,0.01296835882466488,0.006516048009618742,0.003114020380254268,0.001413360950931823,0.0006083966631345416,0.0002480570429374494,9.561800778541788e-05,3.455699969716037e-05,1.082228502090813e-05,0,
0.24853228962818,0.1538131831761089,0.09070895384423255,0.05080917979507039,0.02694952284100435,0.01349760712073482,0.006367059614853982,0.002822109284596978,0.001172812864779076,0.0004560935866408751,0.0001656815848475989,5.612750504795325e-05,1.770236985753072e-05,5.175712310412077e-06,1.331195905839267e-06,0,
0.1859099804305284,0.1062885517529137,0.05692970348945946,0.02842495376581728,0.01316960055805693,0.005638106538929399,0.002221911837726014,0.0008032602673571892,0.0002655624226479522,8.006193505116781e-05,2.195365469627163e-05,5.462176856160541e-06,1.23032788244578e-06,2.502103532443704e-07,4.480525348720417e-08,0,
0.1232876712328767,0.06149121929690199,0.0277435099458973,0.01122050299158395,0.004034336378704024,0.001279987041671432,0.0003559625740371445,8.624544117004635e-05,1.810444805752834e-05,3.275596484583106e-06,5.082565295573118e-07,6.730196552634095e-08,7.567713889242103e-09,7.188622663041873e-10,5.716107767190867e-11,0,
0.06066536203522505,0.02182851041621567,0.006347065111602017,0.001452542930550717,0.0002554268726991488,3.374750344527389e-05,3.276692462446581e-06,2.283779401944155e-07,1.112386711127561e-08,3.664319113678481e-10,7.821558382704485e-12,1.019474487036317e-13,7.425858383626864e-16,2.610482032077172e-18,3.317451314841351e-21,0,
};

double Gdados [] = {
0.9991196780465543,0.7897508811714669,0.6162891860172448,0.4769338125895304,0.3649289699487883,0.2755098236835525,0.2051609485250342,0.1506384157220557,0.1089844463438097,0.07759060000215594,0.05420498453416046,0.03691464173371086,0.0241104325149123,0.01443840981786961,0.006742235473159638,0,
0.9318796911089154,0.7335325062078994,0.5682821100902485,0.4366094515422538,0.3304300657646186,0.2465093438871891,0.1812646128806167,0.1313337165513114,0.09369690634562824,0.06573876669401441,0.04524289294554767,0.03035907930485322,0.01955855530858015,0.01157964535830954,0.005365980977330776,0,
0.9431419143704751,0.6786005014858618,0.5230457965993389,0.3963232978691629,0.2962368157495784,0.2181919015540607,0.1582706769901079,0.1129942171214789,0.07934953299049829,0.05475586794585131,0.03704554895695352,0.02443820240053444,0.0154934993429026,0.009049504310450446,0.004155038230094516,0,
0.8116930942347277,0.6225432820184943,0.4742561197651298,0.3564080699963334,0.2631691200557157,0.1909557634491462,0.1362887856146572,0.09567190199964355,0.0660062340593211,0.0447027628143267,0.02965502791426548,0.01917539507303109,0.01192655355125604,0.006852929550174901,0.00311122686903128,0,
0.7339044597721613,0.5724155897948904,0.4315919585258824,0.317389629115599,0.2302182191768033,0.1644212452807073,0.1154321069829229,0.07956151177007945,0.05378789234981003,0.03563289180422036,0.02309249035702826,0.01457979407499767,0.008862010871006005,0.004991672740944753,0.002235026160706099,0,
0.7127276596374474,0.5136409474830119,0.3812993512613407,0.2780827807052282,0.1988465386162946,0.139571923655135,0.09604143837154532,0.06472893409455259,0.0427025697102775,0.02755595522325251,0.01737024429624537,0.01065959793318249,0.006302121828216681,0.003464284630855256,0.001524615689330976,0,
0.6095541343267883,0.4572246366529033,0.3369508438937159,0.2412285562779773,0.1691739653320176,0.1161562094846777,0.07798319573657322,0.05116067242804254,0.03278438150933936,0.02050886240873314,0.01251027623920437,0.007419995981700612,0.004241000066815655,0.002261484582019128,0.0009736433520998458,0,
0.5773354759363279,0.406611863840279,0.2928658845065315,0.2058294750518886,0.1408877637990086,0.09406781969664912,0.06129123214481537,0.0389504606381964,0.02412052815750457,0.0145418796441335,0.008525783001027203,0.004849956771878909,0.002657493646875797,0.001363095382625565,0.0005702173097834584,0,
0.5205669964421286,0.3615144730478028,0.2504363976171159,0.1705915911161191,0.1134930045989594,0.07348357992649633,0.04625198797296472,0.02828807454011264,0.01679883413762773,0.009676747836892659,0.005400945478643222,0.002915487564001419,0.001513708043799984,0.0007379402994346495,0.0002969773008685409,0,
0.4507003559408356,0.3079402896626059,0.2081071058280213,0.1374036210829566,0.08811345493651865,0.05483565919594243,0.03305931294307975,0.01927783163634527,0.01085890163829977,0.005902234350350507,0.003092839072503074,0.001560518370642845,0.0007552319141991012,0.0003440006401247447,0.0001312250175713227,0,
0.36193260009858,0.2554299071817362,0.1660203097150463,0.1056718015558548,0.06498849163480576,0.03849579235338556,0.02192913563256501,0.01199742694846271,0.006299040160133814,0.003171656642555657,0.001530167969810923,0.0007064585656863248,0.0003112473644539691,0.0001290729188374642,4.556570634055241e-05,0,
0.3135517058584205,0.2005136703119522,0.127543135145111,0.07722965307781868,0.04457413376436225,0.02455880395539369,0.01292434899291404,0.006488184512510708,0.003101066353222288,0.001408396911796098,0.0006067505753447247,0.0002475702934135509,9.54861208570687e-05,3.452335819518712e-05,1.081439232853798e-05,0,
0.2805133186674398,0.1553650084362628,0.09076459750147342,0.05055944474490771,0.02677909802805631,0.01342126187447809,0.006339937666004698,0.002814233431001335,0.001170852439489529,0.0004556370023018067,0.0001655714363581651,5.609893479090018e-05,1.769499932166054e-05,5.174094724413676e-06,1.330961802300335e-06,0,
0.1843473571853862,0.1046948828096638,0.05627645144973945,0.02828905822272948,0.01314455408173836,0.005633145132509084,0.002220795123727153,0.000802917271242966,0.0002654343850975293,8.002312195880685e-05,2.194649868564257e-05,5.462327020715985e-06,1.231056514078096e-06,2.505581574713215e-07,4.491203443791166e-08,0,
0.1230210258995425,0.0615388116111964,0.02781929321049425,0.01122142564126486,0.00402982276563692,0.001278980618664633,0.0003557450337300798,8.622745462774159e-05,1.811837654365812e-05,3.283312760748029e-06,5.105514632379908e-07,6.779583800278607e-08,7.651153307716041e-09,7.301821445334079e-10,5.838843290350747e-11,0,
0.06228296715919285,0.0218128758033845,0.006307560832061583,0.001454430770459073,0.0002560915060386365,3.393555395217045e-05,3.325136375147175e-06,2.350312896952298e-07,1.162847534858488e-08,3.88553536365555e-10,8.386002071638103e-12,1.101103483434787e-13,8.051762289095442e-16,2.833296029801637e-18,3.59606191039941e-21,0
};

#define OsDados(pos,tempo) Gdados[(15-tempo)*16+pos]








//--------------------------------------------------------------
/*! \brief Modelo teórico : equação de calor.
 *
 *  Equação de calor, utilizada como termo de regularização
 *    na função-objetivo.
 */
//--------------------------------------------------------------
double Modelo (double *v) {

   Rede.settheta (v);

   double teste = Rede.calc (v);

   double j = 0;

   double x = 0;
   while (x < 1.0) {


		double t = 0;
		while (t < 1.0) {

         double v[2];
         v[0] = x;
         v[1] = t;
         Rede.calc (v);
         double a = Rede.deriv1(1) - Rede.deriv2 (0, 0);

         j += (a*a);

	      t += G_stept;
      }

      x += G_stepx;
   }

   return j;
}


//--------------------------------------------------------------
/*! \brief Conjunto de dados.
 *
 *  Conjunto de dados utilizados no "treinamento" da rede.
 */
//--------------------------------------------------------------

double Dados (double *v) {

   Rede.settheta (v);

   double j = 0;

   double x[2];

   for (int ix = 0; ix < 16; ix++) 
      for (int it = 0; it < 16; it++) {

         x[0] = ix / 15.;
         x[1] = it / 15.;

         double a = 
               Rede.calc (x) - 
               (OsDados(ix,it));// *  (((double)(rand() % 10000) / 50000.0) + 0.9));

         j += (a*a);

      }

   return j;
};

//-------------------------------------------------
//double Modelo2 (double *v) {
//
//   Rede.settheta (v);
//
//   double teste = Rede.calc (v);
//
//   double j = 0;
//
//   double x = 0;
//   while (x < 1.0) {
//
//      double t = 0;
//      while (t < 1.0) {
//
//         double v[2];
//         v[0] = x;
//         v[1] = t;
//
//         double y = Rede.calc (v);
//
//         double a = (y + (t * Rede.deriv1(1))) - (t * Rede.deriv2 (0, 0));
//
//         j += (a*a);
//
//	      t += G_stept;
//      }
//
//      x += G_stepx;
//   }
//
//   return j;
//}
//

//-------------------------------------------------
//double Dados2 (double *v) {
//
//   Rede.settheta (v);
//
//   double j = 0;
//
//   double x[2];
//
//   for (int ix = 0; ix < 16; ix++) 
//      for (int it = 0; it < 16; it++) {
//
//         x[0] = ix / 15.;
//         x[1] = it / 15.;
//
//         double a = 
//               (x[1] * Rede.calc (x)) - 
//               (OsDados(ix,it));
//
//         j += (a*a);
//
//      }
//
//   return j;
//};
//

//--------------------------------------------------------------
/*! \brief Gera uma parábola (parabolóide) z = f(x,y).
 *
 *  Dados para teste de "treinamento" de rede neural.
 */
//--------------------------------------------------------------
double ParabolaTeste (double *v) {

   Rede.settheta (v);

   double j = 0;

   double x[2];

   for (int ix = 0; ix < 16; ix++) 
      for (int it = 0; it < 16; it++) {

         x[0] = ix / 15.;
         x[1] = it / 15.;

         double a = 
               (x[0]*x[0] + x[1]*x[1]) - 
               Rede.calc(x);

         j += (a*a);

      }

   return j;
};

//--------------------------------------------------------------
/*! \brief Derivadas da parábola (parabolóide) z = f(x,y).
 *
 *  Utilizadas para regularização no "treinamento" de rede neural.
 */
//--------------------------------------------------------------
double DerivadaParabolaTeste (double *v) {

   Rede.settheta (v);

   double j = 0;

   double x[2];

   for (int it = 0; it < 16; it++)
      for (int ix = 0; ix < 16; ix++) {

         x[0] = ix / 15.;
         x[1] = it / 15.;

         Rede.calc (x);

         double a = 2.0 - Rede.deriv2(0, 0);
         double b = 2.0 - Rede.deriv2(1, 1);

         j += ((a*a) + (b*b));

      }

   return j;
};

